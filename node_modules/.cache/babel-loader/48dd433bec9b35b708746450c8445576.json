{"ast":null,"code":"import _classCallCheck from\"/Users/clara/Desktop/404-final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/clara/Desktop/404-final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/clara/Desktop/404-final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/clara/Desktop/404-final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/clara/Desktop/404-final/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{Link}from\"react-router-dom\";import Favorite from\"./../../components/Favorite\";import Modal from\"./../../components/Modal\";import\"./Detail.css\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Detail=/*#__PURE__*/function(_React$Component){_inherits(Detail,_React$Component);var _super=_createSuper(Detail);function Detail(props){var _this;_classCallCheck(this,Detail);_this=_super.call(this,props);_this.state={title:\"\",body:\"\",categoryId:\"\",url:\"\",id:\"\",isFavorite:null,comments:[],comment:\"\",author:\"Me\",time:\"\",isModalOpen:false};_this.handleAuthorChange=_this.handleAuthorChange.bind(_assertThisInitialized(_this));_this.handleCommentChange=_this.handleCommentChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));return _this;}_createClass(Detail,[{key:\"handleCommentChange\",value:function handleCommentChange(event){this.setState({comment:event.target.value});}},{key:\"handleAuthorChange\",value:function handleAuthorChange(event){this.setState({author:event.target.value});}},{key:\"handleSubmit\",value:function handleSubmit(event){var _this2=this;event.preventDefault();var d=new Date();var date=d.toString();fetch(\"https://itp-final.herokuapp.com/api/comments\",{method:\"POST\",body:JSON.stringify({body:this.state.comment,postId:this.state.id,author:this.state.author,time:date}),headers:{\"Content-type\":\"application/json\"}}).then(function(response){return response.json();}).then(function(json){console.log(json);_this2.setState({comment:\"\",postId:\"\",author:\"Me\"});_this2.fetchComments();});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var id=this.props.match.params.postId;fetch(\"https://itp-final.herokuapp.com/api/posts/\".concat(id)).then(function(response){return response.json();}).then(function(json){_this3.setState({title:json.title,body:json.body,categoryId:json.categoryId,url:json.url,id:json.id,isFavorite:json.isFavorite});console.log(json);});}},{key:\"fetchComments\",value:function fetchComments(){var _this4=this;fetch(\"https://itp-final.herokuapp.com/api/comments?_sort=time&_order=desc\").then(function(response){return response.json();}).then(function(comments){_this4.setState({comments:comments});});}},{key:\"deletePost\",value:function deletePost(){var _this5=this;var isDeleteConfirmed=window.confirm(\"Are you sure you want to delete this post?\");if(!isDeleteConfirmed){return;}fetch(\"https://itp-final.herokuapp.com/api/posts/\".concat(this.state.id),{method:\"DELETE\"}).then(function(json){toast.success(\"\".concat(_this5.state.title,\" was deleted\"));_this5.props.history.push(\"/\");});}},{key:\"addFavorite\",value:function addFavorite(){var _this6=this;fetch(\"https://itp-final.herokuapp.com/api/posts/\".concat(this.state.id),{method:\"PUT\",body:JSON.stringify({title:this.state.title,body:this.state.body,categoryId:this.state.categoryId,url:this.state.url,isFavorite:true}),headers:{\"Content-type\":\"application/json\"}}).then(function(response){return response.json();}).then(function(json){console.log(json);toast.success(\"\".concat(_this6.state.title,\" was successfully added to Favorites\"),{theme:\"colored\"});_this6.props.history.push(\"/about\");});}},{key:\"removeFavorite\",value:function removeFavorite(){var _this7=this;fetch(\"https://itp-final.herokuapp.com/api/posts/\".concat(this.state.id),{method:\"PUT\",body:JSON.stringify({title:this.state.title,body:this.state.body,categoryId:this.state.categoryId,url:this.state.url,isFavorite:false}),headers:{\"Content-type\":\"application/json\"}}).then(function(response){return response.json();}).then(function(json){console.log(json);toast.success(\"\".concat(_this7.state.title,\" was successfully removed from Favorites\"),{theme:\"colored\"});_this7.props.history.push(\"/\");});}},{key:\"render\",value:function render(){var _this8=this;this.fetchComments();return/*#__PURE__*/_jsxs(\"div\",{className:\"Detail\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"title\",children:this.state.title}),/*#__PURE__*/_jsx(\"button\",{// type=\"submit\"\nclassName:\"btn btn-outline-dark btn-lg like\",onClick:function onClick(){!_this8.state.isFavorite?_this8.addFavorite():_this8.removeFavorite();},children:/*#__PURE__*/_jsx(Favorite,{likeValue:this.state.isFavorite})}),/*#__PURE__*/_jsx(\"p\",{children:this.state.body}),this.state.isModalOpen&&/*#__PURE__*/_jsx(Modal,{title:this.state.title,body:function body(){return/*#__PURE__*/_jsx(\"img\",{src:_this8.state.url,alt:\"\"});},onClose:function onClose(){_this8.setState({isModalOpen:false});},id:this.state.id}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-6\",children:[/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){_this8.setState({isModalOpen:true});},className:\"img\",src:this.state.url,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"group\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger btn-lg bttn\",onClick:function onClick(){_this8.deletePost();},children:\"Delete\"}),/*#__PURE__*/_jsx(Link,{type:\"button\",className:\"btn btn-success btn-lg bttn2\",to:\"/board/\".concat(this.props.match.params.postId,\"/edit\"),children:\"Edit\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments col-6\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-2\",children:/*#__PURE__*/_jsxs(\"select\",{value:this.state.author,onChange:this.handleAuthorChange,className:\"form-select form-select-md border-0 bg-light\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Me\",children:\"Me \\uD83D\\uDC67\\uD83C\\uDFFB\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Clara\",children:\"Clara\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Taemin\",children:\"Taemin\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Wanna say something?\",value:this.state.comment,onChange:this.handleCommentChange}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"submit\",children:\"Comment\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"list-group\",children:this.state.comments&&this.state.comments.map(function(comment){if(comment.postId===_this8.state.id){return/*#__PURE__*/_jsxs(\"div\",{className:\"list-group-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsx(\"h5\",{children:comment.author}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:moment(comment.time).calendar()})]}),/*#__PURE__*/_jsx(\"p\",{children:comment.body})]},comment.id);}return/*#__PURE__*/_jsx(_Fragment,{});})})]})]})]});}}]);return Detail;}(React.Component);export{Detail as default};","map":{"version":3,"sources":["/Users/clara/Desktop/404-final/src/pages/home/Detail.js"],"names":["React","toast","Link","Favorite","Modal","moment","Detail","props","state","title","body","categoryId","url","id","isFavorite","comments","comment","author","time","isModalOpen","handleAuthorChange","bind","handleCommentChange","handleSubmit","event","setState","target","value","preventDefault","d","Date","date","toString","fetch","method","JSON","stringify","postId","headers","then","response","json","console","log","fetchComments","match","params","isDeleteConfirmed","window","confirm","success","history","push","theme","addFavorite","removeFavorite","deletePost","map","calendar","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { Link } from \"react-router-dom\";\nimport Favorite from \"./../../components/Favorite\";\nimport Modal from \"./../../components/Modal\";\nimport \"./Detail.css\";\nimport moment from \"moment\";\n\nexport default class Detail extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      title: \"\",\n      body: \"\",\n      categoryId: \"\",\n      url: \"\",\n      id: \"\",\n      isFavorite: null,\n      comments: [],\n      comment: \"\",\n      author: \"Me\",\n      time: \"\",\n      isModalOpen: false,\n    };\n\n    this.handleAuthorChange = this.handleAuthorChange.bind(this);\n    this.handleCommentChange = this.handleCommentChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n  handleCommentChange(event) {\n    this.setState({ comment: event.target.value });\n  }\n  handleAuthorChange(event) {\n    this.setState({ author: event.target.value });\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n\n    let d = new Date();\n    let date = d.toString();\n\n    fetch(\"https://itp-final.herokuapp.com/api/comments\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        body: this.state.comment,\n        postId: this.state.id,\n        author: this.state.author,\n        time: date,\n      }),\n      headers: {\n        \"Content-type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((json) => {\n        console.log(json);\n        this.setState({\n          comment: \"\",\n          postId: \"\",\n          author: \"Me\",\n        });\n        this.fetchComments();\n      });\n  }\n\n  componentDidMount() {\n    const id = this.props.match.params.postId;\n    fetch(`https://itp-final.herokuapp.com/api/posts/${id}`)\n      .then((response) => {\n        return response.json();\n      })\n      .then((json) => {\n        this.setState({\n          title: json.title,\n          body: json.body,\n          categoryId: json.categoryId,\n          url: json.url,\n          id: json.id,\n          isFavorite: json.isFavorite,\n        });\n        console.log(json);\n      });\n  }\n\n  fetchComments() {\n    fetch(`https://itp-final.herokuapp.com/api/comments?_sort=time&_order=desc`)\n      .then((response) => {\n        return response.json();\n      })\n      .then((comments) => {\n        this.setState({ comments });\n      });\n  }\n\n  deletePost() {\n    const isDeleteConfirmed = window.confirm(\n      \"Are you sure you want to delete this post?\"\n    );\n\n    if (!isDeleteConfirmed) {\n      return;\n    }\n\n    fetch(`https://itp-final.herokuapp.com/api/posts/${this.state.id}`, {\n      method: \"DELETE\",\n    }).then((json) => {\n      toast.success(`${this.state.title} was deleted`);\n      this.props.history.push(\"/\");\n    });\n  }\n\n  addFavorite() {\n    fetch(`https://itp-final.herokuapp.com/api/posts/${this.state.id}`, {\n      method: \"PUT\",\n      body: JSON.stringify({\n        title: this.state.title,\n        body: this.state.body,\n        categoryId: this.state.categoryId,\n        url: this.state.url,\n        isFavorite: true,\n      }),\n      headers: {\n        \"Content-type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((json) => {\n        console.log(json);\n        toast.success(\n          `${this.state.title} was successfully added to Favorites`,\n          { theme: \"colored\" }\n        );\n        this.props.history.push(\"/about\");\n      });\n  }\n\n  removeFavorite() {\n    fetch(`https://itp-final.herokuapp.com/api/posts/${this.state.id}`, {\n      method: \"PUT\",\n      body: JSON.stringify({\n        title: this.state.title,\n        body: this.state.body,\n        categoryId: this.state.categoryId,\n        url: this.state.url,\n        isFavorite: false,\n      }),\n      headers: {\n        \"Content-type\": \"application/json\",\n      },\n    })\n      .then((response) => {\n        return response.json();\n      })\n      .then((json) => {\n        console.log(json);\n        toast.success(\n          `${this.state.title} was successfully removed from Favorites`,\n          { theme: \"colored\" }\n        );\n        this.props.history.push(\"/\");\n      });\n  }\n\n  render() {\n    this.fetchComments();\n\n    return (\n      <div className=\"Detail\">\n        <h3 className=\"title\">{this.state.title}</h3>\n        <button\n          // type=\"submit\"\n          className=\"btn btn-outline-dark btn-lg like\"\n          onClick={() => {\n            !this.state.isFavorite ? this.addFavorite() : this.removeFavorite();\n          }}\n        >\n          <Favorite likeValue={this.state.isFavorite} />\n        </button>\n        <p>{this.state.body}</p>\n        {this.state.isModalOpen && (\n          <Modal\n            title={this.state.title}\n            body={() => {\n              return <img  src={this.state.url} alt=\"\" />;\n            }}\n            onClose={() => {\n              this.setState({ isModalOpen: false });\n            }}\n            id={this.state.id}\n          />\n        )}\n        <div className=\"row\">\n          <div className=\"col-6\">\n            <img onClick={() => {\n                      this.setState({ isModalOpen: true });\n                    }} className=\"img\" src={this.state.url} alt=\"\" />\n            <div className=\"group\">\n              <button\n                type=\"button\"\n                className=\"btn btn-danger btn-lg bttn\"\n                onClick={() => {\n                  this.deletePost();\n                }}\n              >\n                Delete\n              </button>\n              <Link\n                type=\"button\"\n                className=\"btn btn-success btn-lg bttn2\"\n                to={`/board/${this.props.match.params.postId}/edit`}\n              >\n                Edit\n              </Link>\n            </div>\n          </div>\n          <div className=\"comments col-6\">\n            <form onSubmit={this.handleSubmit}>\n              <div className=\"mb-2\">\n                {/* <label className=\"form-label \">Category</label> */}\n                <select\n                  value={this.state.author}\n                  onChange={this.handleAuthorChange}\n                  className=\"form-select form-select-md border-0 bg-light\"\n                >\n                  <option value=\"Me\">Me 👧🏻</option>\n                  <option value=\"Clara\">Clara</option>\n                  <option value=\"Taemin\">Taemin</option>\n                </select>\n              </div>\n              <div className=\"input-group mb-3\">\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  placeholder=\"Wanna say something?\"\n                  value={this.state.comment}\n                  onChange={this.handleCommentChange}\n                />\n                <button className=\"btn btn-primary\" type=\"submit\">\n                  Comment\n                </button>\n              </div>\n            </form>\n            <div className=\"list-group\">\n              {/* <button\n                className=\"btn btn-outline-dark\"\n                onClick={() => {\n                  this.fetchComments();\n                }}\n              >\n                View\n              </button> */}\n              {this.state.comments &&\n                this.state.comments.map((comment) => {\n                  if (comment.postId === this.state.id) {\n                    return (\n                      <div className=\"list-group-item\" key={comment.id}>\n                        <div className=\"d-flex justify-content-between\">\n                          <h5>{comment.author}</h5>\n                          <small className=\"text-muted\">\n                            {moment(comment.time).calendar()}\n                          </small>\n                        </div>\n                        <p>{comment.body}</p>\n                      </div>\n                    );\n                  }\n                  return <></>;\n                })}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}